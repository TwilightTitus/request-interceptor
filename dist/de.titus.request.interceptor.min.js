!function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(o,r,function(e){return t[e]}.bind(null,r));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=4)}([function(t,e,n){"use strict";const o=[],r={},i={interceptors:[],doIntercept:function(t,e){console.log("origin",t.origin),function(t,e){let n=r[t.server];if(void 0!==n)return Promise.resolve(n);n=[];let i=[];return o.forEach(function(e){i.push(e.doAccept(t).then(function(t){t&&n.push(e)}))}),console.log("promises",i),Promise.all(i).then(function(){return r[t.origin]=n,n}).catch(function(t){throw t})}(t).then(function(t){return console.log("chain",t),t}).then(function(n){let o=[];return n.forEach(function(n){o.push(n.doHandle(t,e))}),Promise.all(o)}).then(function(){return Promise.resolve(t,e)}).catch(console.error)},addInterceptor:function(t){if(1!=arguments.length&&"object"!=typeof t)throw new Error("function required an interceptor");if("function"!=typeof t.doAccept)throw new Error('The interceptor required a "doAccept" function!');if("function"!=typeof t.doHandle)throw new Error('The interceptor required a "doHandle" function!');return o.push(t),i}};e.a=i},function(t,e,n){"use strict";e.a={URLSPLITTER:/^((([^:\/]*:)?\/\/)?([^:\/]*)(\:([0-9]*))?)(\/.*)?$/}},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";var o=function(t){const e=t,n=void 0;return setInterval(function(){new Promise(e.fetchToken).then(function(t){n=t})},e.refreshInterval||6e4),{doAccept:e.doAccept||function(t){return new Promise(function(n){let o=typeof e.condition;if("function"===o)n(e.condition(t));else if("string"===o)n(e.condition==t.origin);else if(e.condition instanceof Array)for(let o=0;o<e.condition.length;o++)e.condition[o]==t.origin&&n(!0);n(!1)})},doHandle:function(t,o){let r=o instanceof XMLHttpRequest?e.appendJwtOnXhr:e.appendJwtOnFetch;return void 0!==n?r(o,n):new Promise(e.fetchToken).then(function(t){n=t,r(o,n)})}}};const r=function(t,e){return new Promise(function(){t.headers=t.header||{},t.headers.Authorization="Bearer "+e})},i=function(t,e){return new Promise(function(){t.setRequestHeader("Authorization","Bearer "+aToken)})};const c={OAuthInterceptor:function(t){let e=t;return e.fetchToken=function(){return fetch(e.login.url,{method:e.login.method||"get"}).then(function(t){return t.json()}).then(function(t){return t[e.login.response.valueSelector]})},e.appendJwtOnFetch=r,e.appendJwtOnXhr=i,o(t)},TokenInterceptor:o};e.a=c},function(t,e,n){"use strict";n.r(e);n(5)},function(t,e,n){"use strict";(function(t){n(6),n(7);var e,o=n(0),r=n(3);(e=window||t||{}).de=e.de||{},e.de.titus=e.de.titus||{},e.de.titus.request=e.de.titus.request||{},e.de.titus.request.interceptor={VERSION:"1.0.0-beta2",Manager:o.a,interceptors:r.a},e.RequestInterceptManager=o.a}).call(this,n(2))},function(t,e,n){"use strict";var o=n(0),r=n(1);if("undefined"!=typeof XMLHttpRequest){const t=XMLHttpRequest.prototype.open,e=XMLHttpRequest.prototype.send;XMLHttpRequest.prototype.open=function(){console.log("o1");let e=r.a.URLSPLITTER.exec(arguments[1]);return console.log("o2"),this.__interceptorRequestData={method:arguments[0],url:arguments[1],origin:e[1]||document.location.origin,protocol:function(t){return void 0===t[2]||"//"==t[3]?document.location.protocol||"http:":t[3]}.call(null,e),hostname:e[4]||document.location.hostname,port:e[6],query:e[7],async:"boolean"!=typeof arguments[2]||arguments[2]},console.log("o3"),t.apply(this,arguments)},XMLHttpRequest.prototype.send=function(){console.log("1");let t=e.bind(this,arguments);console.log("2");let n=o.a.doIntercept(this.__interceptorRequestData,this);return console.log("3",n),n.then(function(e,n){return t()}).catch(function(t){throw t}),this}}},function(t,e,n){"use strict";(function(t){var e=n(0),o=n(1);!function(t){if("function"==typeof t.fetch){const n=t.fetch;t.fetch=function(t,r){let i=n.bind(this,arguments),c=r||{},u=o.a.URLSPLITTER.exec(t),s={method:c.method||"GET",url:t,origin:u[1]||document.location.origin,protocol:function(t){return void 0===t[2]||"//"==t[3]?document.location.protocol||"http:":t[3]}.call(null,u),hostname:u[4]||document.location.hostname,port:u[6],query:u[7],async:!0};return e.a.doIntercept(s,c).then(function(){return i()}).catch(function(t){throw t})}}}(window||t||{})}).call(this,n(2))}]);
//# sourceMappingURL=de.titus.request.interceptor.min.js.map