!function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(o,r,function(e){return t[e]}.bind(null,r));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=4)}([function(t,e,n){"use strict";const o=[],r={},i={config:{ignoreDocumentOrigin:!0,ignoreOrigins:[]},interceptors:[],doIntercept:function(t){return i.config.ignoreDocumentOrigin&&t.metadata.origin==document.location.origin?Promise.resolve(t):void 0!==i.config.ignoreOrigins&&function(t,e){for(let n=0;n<e.length;n++)if(t.metadata.origin==e[n])return!0;return!1}(t,i.config.ignoreOrigins)?Promise.resolve(t):function(t,e){let n=r[t.metadata.origin];if(void 0!==n)return Promise.resolve(n);let i=[];return o.forEach(function(e){let n=Promise.resolve(e.doAccept(t)).then(function(t){if(t)return e});i.push(n)}),Promise.all(i).then(function(e){const n=e.filter(function(t){return void 0!==t});return r[t.metadata.origin]=n,n}).catch(function(t){throw t})}(t).then(function(e){if(void 0===e||0==e.length)return Promise.resolve(t);let n=Promise.resolve(t);return e.forEach(function(t){n.then(t.doHandle)}),n}).catch(function(t){throw t})},addInterceptor:function(t){if(1!=arguments.length&&"object"!=typeof t)throw new Error("function required an interceptor");if("function"!=typeof t.doAccept)throw new Error('The interceptor required a "doAccept" function!');if("function"!=typeof t.doHandle)throw new Error('The interceptor required a "doHandle" function!');return o.push(t),i}};e.a=i},function(t,e,n){"use strict";e.a={URLSPLITTER:/^((([^:\/]*:)?\/\/)?([^:\/]*)(\:([0-9]*))?)(\/.*)?$/}},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";var o=function(t){const e=t;let n=void 0;const o=function(){new Promise(e.fetchToken).then(function(t){n=t})};if(e.refreshInterval>0){const t=o;"function"==typeof e.refreshToken&&(t=function(){Promise.resolve(e.refreshToken()).then(function(t){n=t})}),setInterval(t,e.refreshInterval||6e4)}return{doAccept:e.doAccept||function(t){let n=typeof e.condition;if("function"===n)return Promise.resolve(e.condition(t));if("string"===n)return Promise.resolve(e.condition==t.metadata.origin);if(e.condition instanceof Array)for(let n=0;n<e.condition.length;n++)if(e.condition[n]==t.metadata.origin)return Promise.resolve(!0);return Promise.resolve(!1)},doHandle:function(t){let o=t.request instanceof XMLHttpRequest?e.appendOnXhr:e.appendOnFetch;return void 0!==n?Promise.resolve(o(t,n)):Promise.resolve(e.fetchToken(t)).then(function(e){return n=e,Promise.resolve(o(t,n))}).catch(function(t){throw t})}}};const r=function(t,e){return t.request.headers=t.request.headers||{},t.request.headers.Authorization="Bearer "+e,t},i=function(t,e){return t.request.setRequestHeader("Authorization","Bearer "+e),t};const c={OAuthInterceptor:function(t){let e=t;return e.fetchToken=function(){return fetch(e.login.url,{method:e.login.method||"get"}).then(function(t){return t.json()}).then(function(t){return t[e.login.response.valueSelector]}).catch(function(t){throw t})},e.appendOnFetch=r,e.appendOnXhr=i,o(t)},TokenInterceptor:o};e.a=c},function(t,e,n){"use strict";n.r(e);n(5)},function(t,e,n){"use strict";(function(t){n(6),n(7);var e,o=n(0),r=n(3);(e=window||t||{}).de=e.de||{},e.de.titus=e.de.titus||{},e.de.titus.request=e.de.titus.request||{},e.de.titus.request.interceptor={VERSION:"1.0.0-beta3",Manager:o.a,interceptors:r.a},e.RequestInterceptManager=o.a}).call(this,n(2))},function(t,e,n){"use strict";var o=n(0),r=n(1);if("undefined"!=typeof XMLHttpRequest){const t=XMLHttpRequest.prototype.open,e=XMLHttpRequest.prototype.send;XMLHttpRequest.prototype.open=function(){let e=r.a.URLSPLITTER.exec(arguments[1]);return this.__data={url:arguments[1],request:this,metadata:{method:arguments[0],origin:e[1]||document.location.origin,protocol:function(t){return void 0===t[2]||"//"==t[3]?document.location.protocol||"http:":t[3]}.call(null,e),hostname:e[4]||document.location.hostname,port:e[6],query:e[7],async:"boolean"!=typeof arguments[2]||arguments[2]},__arguments:arguments},t.apply(this,arguments)},XMLHttpRequest.prototype.send=function(){if(this.__data.metadata.async){let t=function(t){return e.apply(this,t)}.bind(this,arguments);return o.a.doIntercept(this.__data).then(function(e,n){try{return t()}catch(t){throw t}}).catch(console.error),this}return console.warn(new Error("request interceptor don't support syncronized requests")),e.apply(this,arguments)}}},function(t,e,n){"use strict";(function(t){var e=n(0),o=n(1);!function(t){if("function"==typeof t.fetch){const n=t.fetch;t.fetch=function(t,r){let i=r||{},c=o.a.URLSPLITTER.exec(t),u={url:t,request:r,metadata:{method:i.method||"GET",origin:c[1]||document.location.origin,protocol:function(t){return void 0===t[2]||"//"==t[3]?document.location.protocol||"http:":t[3]}.call(null,c),hostname:c[4]||document.location.hostname,port:c[6],query:c[7],async:!0}};return e.a.doIntercept(u).then(function(t){return n(t.url,t.request)}).catch(function(t){throw t})}}}(window||t||{})}).call(this,n(2))}]);
//# sourceMappingURL=de.titus.request.interceptor.min.js.map